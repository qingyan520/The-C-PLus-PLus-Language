### mysql的基本查询

> 数据库的基本操作有四种,增删查改,增加数据,删除数据,查找数据,修改数据

#### insert插入语句

Create 

创建表

```sql
create table t20(
	id int unsigned primary key auto_increment comment '主键',
    sn int unsigned not null unqiue comment '学号',
    name varchar(20) not null,
    qq varchar(12)
)engine=InnoDB default chsrset=utf8;
```

插入语句

单行插入

```slq
insert t20(sn,name,qq) values(123,'猪八戒','1234567');
```

多行行插入

```sql
insert t20(sn,name,qq) values(123,'猪八戒','1234567'),
(125,'hello','456789');
```

```sql
insert into t20(id,name,qq) values(5,'hsjl','585785');
```

当出现主键和唯一键冲突

```sql
insert into t10 values(1,123,'猪悟能','55555') on duplicate key name='猪悟能',qq='555555';
//该语句可以在出现主键或者唯一键冲突时进行更新
```

替换

```sql
主键或者唯一教案没有冲突，则直接插入
主键或者唯一键由冲突，则删除后再插入
replace  into t20  values(3.125,'李四','55618415');
```

#### select查询语句

6.2Retrieve

查询语句

6.2.1select 查询

全列查询

```sql
//通常情况下不建议使用*进行全列查询

select * from exam_result;
```

查询指定列

```sql
select name,math ,id from exam_result
```

查询字段包含表达式

mysql会自动计算表达式的值

```sql
select name,math.chinses,math+chinsex+englist as 总分 from exam_result;
```

为查询结果指定别名

```sql
select name as '姓名',age as '年龄' from student
```

去重distinct

```sql
select distinct math from exam_result;
```

筛选条件

```sql
select name,math form exam_result where math>80;
```

where条件

比较运算符

![image-20220418163216424](https://raw.githubusercontent.com/qingyan520/Cloud_img/master/img/image-20220418163216424.png)



逻辑运算符

| 运算符 | 说明                              |
| ------ | --------------------------------- |
| AND    | 多个条件必须都为TRUE,结果才为TRUE |
| OR     | 任意一个条件为 true 结果为true    |
| NOT    | 条件为true,结果为false            |

数学成绩是58，59或者98 ，99的同学

```sql
select name,math from exam_result where math in (58,59,98,99);
```



模糊匹配

```
select name from exam_result where name like '孙%';
```

```sql
select name from exam_result where name like '孙_';
```

挑选总分在200以下的同学

```sql
select name chinese+english+math as '总分' from exam_result where chinese+english+math<200
```

where后续的子句本身就是在我们select期间要进行作为条件筛选的

语文成绩>80并且不姓孙

```sql
select name chinese where chinses>80 and not like '孙%';
```

孙某同学，否则要求总成绩>200并且语文成绩<数学成绩并且英文成绩>80

```sql
select name chinese math english from exam_result  where like '孙_'or (english+math+chinese>200 and chinses<math and english>80);
```

结果排序

```sql
order by 
asc 升序，在不指定的情况下默认为升序
desc 降序
注意:order by没有自居的查询,返回的顺序是未定义的,永远不要依赖这个顺序
```

```sql
select name,math from exam_result order by math;
//默认是升序排列
select name,math from exam_result order by math desc;
```

挑选同学及qq号，按照qq号码进行排序

```sql
select name,qq from t20 where sn is not null order by qq ;
```

查询各科成绩，一次按照数学降序，英语升序，语文升序的方式显示

```sql
select name,chinses ,math englist from exam_result where order by math desc,englist asc,chinses asc;
```

```sql
select name,chinses+math+englist as total from exam_result where order by total;
```

筛选分页结果

limit 

```sql
select * from  limit 3;
//显示前3行

select * from limit 3,2;
//从3号下标开始显示2个

select * from exam_result limit 2 offset 3;
//和上面那个其实是一样的作用

```





#### Update跟新数据

语法

```sql
update table_name set column=expr [,column=expr][where...][order by][limit...] 
```

更新数据

修改数据之前必须先找到数据然后才能进行修改

将孙权同学的数学成绩变为89分

```sql
updata exam_result set math=80 where name='孙权';
```

将孙悟空的math改为60分,Chinese改为70分

```sql
update exam_result set math=60,chinses=70 where name='孙悟空';
```

总成绩倒数前三的三名同学数学成绩+30分

```sql
update exam_result set math=math+30 order by chinese+math+english limit 3;

```

将所有人的语文成绩变为原来的2倍

```sql
updata exam_result set chinese=chinses*2;
```

#### delete删除数据

```sql
delete from table_name [where...][order by...][limit...]
```

删除

删除之前要找到数据

```sql
delete from exam_result where name='孙悟空';

```

 删除总分是倒数三名的学生

```sql
delete from exam_result where name in(select name where order by english+math+chinses desc limit 3);
```

清空表数据

```sql
delete from exam_result ;
```

截断表

```sql
truncate [table] table_name;
```

注意:这个操作慎用

1.只能对整表操作,不能像delete一样对部分数据操作

2.实际上MySQL不会对数据操作,所以比delete更快,但是truncate在删除数据的时候,并不经过真正的事务,所以无法回滚

3.此操作会重置AUTO_INCREMENT项

插入查询结果

```sql
create table if not exists dup_table(
	id int,
    name varchar(20)
);
```

```sql
insert into dup_table values(100,'aaa'),(200,'bbb'),(300,'ccc'),(100,'aaa');
```

表格去重

```sql
create table if not exists no_dup_table like dup_table;
```



```sql
insert into no_dup_table select distinct * from dup_table;
```

```sql
rename table dup_taable to dup_table_back,no_dup_table to dup_table;
```



聚合函数

```sql
count():统计次数
sum():求总和
avg():平均值
max():最大值
min():最小值
```



group by子句的使用

```sql
group by可以进行分组查询
```

凡是在select后面的列名称，如果后续我们要进行group by分组，那么凡是在select中出现的原表中的列名称也必须在group by中出现

group by 是一个分组函数，要筛查的数据列，都应该要考虑，分组的时候，如果当前的分组条件相同，接下来的分组依据是什么？

```sql
having 和group by搭配使用，对分组进行筛选，作用有点像where
```

